imports:
  - http://dice-project.github.io/cloudify-openstack-plugin/1.4/plugin.yaml


inputs:

  agent_user:
    description: >-
      User that can be used to login to cloud image (for Ubuntu images, this
      should normally be set to ubuntu, for Centos to centos).

  small_image_id:
    description: >-
      OpenStack id of the image that should be used on small instances.

  small_flavor_id:
    description: >-
      OpenStack id of the flavor that should be used on small instances.

  medium_image_id:
    description: >-
      OpenStack id of the image that should be used on medium instances.

  medium_flavor_id:
    description: >-
      OpenStack id of the flavor that should be used on medium instances.

  large_image_id:
    description: >-
      OpenStack id of the image that should be used on large instances.

  large_flavor_id:
    description: >-
      OpenStack id of the flavor that should be used on large instances.


node_types:

  dice.firewall_rules.Base:
    derived_from: cloudify.openstack.nodes.SecurityGroup

  dice.VirtualIP:
    derived_from: cloudify.openstack.nodes.FloatingIP

  dice.hosts.Custom:
    derived_from: cloudify.openstack.nodes.Server
    properties:
      cloudify_agent:
        default:
          user: { get_input: agent_user }

  dice.hosts.Small:
    derived_from: dice.hosts.Custom
    properties:
      image:
        default: { get_input: small_image_id }
      flavor:
        default: { get_input: small_flavor_id }

  dice.hosts.Medium:
    derived_from: dice.hosts.Custom
    properties:
      image:
        default: { get_input: medium_image_id }
      flavor:
        default: { get_input: medium_flavor_id }

  dice.hosts.Large:
    derived_from: dice.hosts.Custom
    properties:
      image:
        default: { get_input: large_image_id }
      flavor:
        default: { get_input: large_flavor_id }


relationships:

  dice.relationships.ProtectedBy:
    derived_from: cloudify.openstack.server_connected_to_security_group

  dice.relationships.IPAvailableFrom:
    derived_from: cloudify.openstack.server_connected_to_floating_ip
